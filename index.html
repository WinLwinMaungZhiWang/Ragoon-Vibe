<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Rangoon_Vibe</title>
<style>
html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
    background: #222;
    font-family: sans-serif;
}

.viewer {
    width: 100vw;
    height: 100vh;
    perspective: 2000px;
    cursor: pointer;
    position: relative;
}

.page {
    width: 100%;
    height: 100%;
    position: absolute;
    background-size: contain;
    background-repeat: no-repeat;
    background-position: center;
    backface-visibility: hidden;
    transform-style: preserve-3d;
}

.flip-page {
    transform-origin: left center;
    transition: transform 1.5s ease; /* slower flip */
}

.flip-page.reverse {
    transform-origin: right center;
}

.flip-page .backface {
    transform: rotateY(180deg);
}
</style>
</head>
<body>

<div class="viewer" id="viewer">
    <div id="currentPage" class="page"></div>
    <div id="flipPage" class="page flip-page">
        <div class="backface page"></div>
    </div>
</div>

<script>
let page = 1;
const maxPages = 7;

const viewer = document.getElementById("viewer");
const currentPage = document.getElementById("currentPage");
const flipPage = document.getElementById("flipPage");
const flipBack = flipPage.querySelector(".backface");

function showPage(number) {
    currentPage.style.backgroundImage = `url('page${number}.png')`;
}

// initial
showPage(page);

let flipping = false;

// flip forward
function nextPage() {
    if (flipping) return;
    flipping = true;

    let nextPageNum = page + 1;
    if (nextPageNum > maxPages) nextPageNum = 1;

    flipPage.style.backgroundImage = `url('page${page}.png')`;
    flipBack.style.backgroundImage = `url('page${nextPageNum}.png')`;

    flipPage.classList.remove("reverse");
    flipPage.style.transform = "rotateY(-180deg)";

    setTimeout(() => {
        page = nextPageNum;
        showPage(page);
        flipPage.style.transition = "none";
        flipPage.style.transform = "rotateY(0deg)";
        flipPage.offsetHeight; // force reflow
        flipPage.style.transition = "transform 1.5s ease";
        flipping = false;
    }, 1500);
}

// flip backward
function prevPage() {
    if (flipping) return;
    flipping = true;

    let prevPageNum = page - 1;
    if (prevPageNum < 1) prevPageNum = maxPages;

    flipPage.style.backgroundImage = `url('page${page}.png')`;
    flipBack.style.backgroundImage = `url('page${prevPageNum}.png')`;

    flipPage.classList.add("reverse");
    flipPage.style.transform = "rotateY(180deg)";

    setTimeout(() => {
        page = prevPageNum;
        showPage(page);
        flipPage.style.transition = "none";
        flipPage.style.transform = "rotateY(0deg)";
        flipPage.offsetHeight;
        flipPage.style.transition = "transform 1.5s ease";
        flipping = false;
    }, 1500);
}

// touch/swipe support
let touchStartX = 0;
let touchEndX = 0;

viewer.addEventListener("touchstart", (e) => {
    touchStartX = e.changedTouches[0].screenX;
}, {passive: true});

viewer.addEventListener("touchend", (e) => {
    touchEndX = e.changedTouches[0].screenX;
    handleGesture();
}, {passive: true});

function handleGesture() {
    const delta = touchEndX - touchStartX;
    if (Math.abs(delta) < 30) return; // small movement ignored

    if (delta > 0) {
        prevPage(); // swipe right -> previous
    } else {
        nextPage(); // swipe left -> next
    }
}

// optional: tap left/right for desktop
viewer.addEventListener("click", (e) => {
    const rect = viewer.getBoundingClientRect();
    const x = e.clientX - rect.left;

    if (x < rect.width / 2) {
        prevPage();
    } else {
        nextPage();
    }
});
</script>

</body>
</html>

